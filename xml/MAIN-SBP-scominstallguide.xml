<?xml version="1.0" encoding="UTF-8"?>
<!--<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>-->
<!DOCTYPE article [
<!ENTITY % entity SYSTEM "entity-decl.ent">
%entity;
]>
<article xmlns="http://docbook.org/ns/docbook"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
    xml:id="art.sbp.scominstallguide" xml:lang="en">
    <info>
        <title>SUSE Manager Management Pack for Microsoft System Center
            Operations Manager</title>
        <subtitle>Installation Guide</subtitle>
        <orgname>SUSE Best Practices</orgname>
        <productname>SUSE Manager Management Pack for Microsoft System
            Center Operations Manager</productname>
        <productnumber> </productnumber>


        <author>
            <personname>
                <firstname>Dobrin</firstname>
                <surname>Dobrev</surname>
            </personname>
            <affiliation>
                <jobtitle>Product Manager</jobtitle>
                <orgname>&suse;</orgname>
            </affiliation>
        </author>


        <date>June 16,2016 </date>


        <abstract>
            <para>Using separate tools to maintain and patch systems,
                monitor health compliance and deploy required updates to
                the Windows and Linux servers can be costly and
                time–consuming. With SUSE Manager Management Pack for
                Microsoft System Center Operations Manager, Windows systems
                administrators are able to view server health information
                and perform both Windows and Linux patching duties, all
                through the same familiar console. This document leads you
                through the initial installation of SUSE Manager Management
                Pack for Microsoft System Center Operations Manager.</para>

        </abstract>
    </info>

    <sect1 xml:id="sec.prerequisites">
        <title>Prerequisites</title>

        <para>SUSE Manager Management Pack for Microsoft System Center
            Operations Manager requires a working environment with
            Microsoft System Center Operations Manager(SCOM) and SUSE
            Manager. The following list outlines the environment and
            software that should be prepared prior to the installation of
            the SUSE Manager Management Pack. </para>

        <itemizedlist>
            <listitem>
                <para>Supported Operating Systems: <itemizedlist>
                        <listitem>
                            <para>Windows Server 2008/2008 R2</para>
                        </listitem>
                    </itemizedlist>
                    <itemizedlist>
                        <listitem>
                            <para>Windows Server 2012/2012 R2</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>Typical environment required for the SUSE Manager
                    Management Pack: <itemizedlist>
                        <listitem>
                            <para>Windows Domain Controller (recommended
                                for domain accounts that are used for the
                                installation of Microsoft System Center
                                Operations Manager)</para>
                        </listitem>
                        <listitem>
                            <para>SQL Server 2008/R2 and above (required
                                for the installation of Microsoft System
                                Center Operations Manager)</para>
                        </listitem>
                        <listitem>
                            <para>One of the following Microsoft System
                                Center Operations Manager versions: <itemizedlist>
                                    <listitem>
                                     <para>Microsoft System Center
                                     Operation Manager 2007 R2 (preferably
                                     with Cumulative Update 6 or later) <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2007 R2 Documentation and
                                     Deployment Guide -
                                     http://technet.microsoft.com/en-us/library/bb310604.aspx</para>
                                     </listitem>
                                     </itemizedlist>
                                     <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2007 R2 Cumulative Update 6
                                     Download -
                                     http://www.microsoft.com/en-us/download/details.aspx?id=29850</para>
                                     </listitem>
                                     </itemizedlist>
                                     <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2007 R2 Cumulative Update 6
                                     Instructions -
                                     http://support.microsoft.com/kb/2626076</para>
                                     </listitem>
                                     </itemizedlist>
                                     </para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft System Center
                                     Operations Manager 2012/R2 (preferably
                                     with the latest Update Rollup) <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2012/R2 Documentation and
                                     Deployment Guide -
                                     http://technet.microsoft.com/en-us/library/hh205987.aspx</para>
                                     </listitem>
                                     </itemizedlist>
                                     <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2012/R2 Update Rollup 2
                                     Download -
                                     http://www.microsoft.com/en-us/download/details.aspx?id=30421</para>
                                     </listitem>
                                     </itemizedlist>
                                     <itemizedlist>
                                     <listitem>
                                     <para>SCOM 2012 Update Rollup 2
                                     Install Instructions -
                                     http://support.microsoft.com/kb/2706783</para>
                                     </listitem>
                                     </itemizedlist>
                                     </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                        <listitem>
                            <para>SUSE Manager 1.7, 2.1 and 3</para>
                        </listitem>
                        <listitem>
                            <para>Linux virtual machines with distribution
                                versions supported by both the SCOM Cross
                                Platform Management Packs and SUSE
                                Manager</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>Microsoft System Center Operations Manager
                    Requirements <itemizedlist>
                        <listitem>
                            <para>The cross platform management packs which
                                add support for monitoring Unix/Linux
                                systems must be installed. They are
                                available for download from the following
                                links: <itemizedlist>
                                    <listitem>
                                     <para>SCOM 2007 R2 Cross Platform
                                     Management Packs -
                                     http://www.microsoft.com/en-us/download/details.aspx?id=18891</para>
                                    </listitem>
                                    <listitem>
                                     <para>SCOM 2012 Cross Platform
                                     Management Packs -
                                     http://www.microsoft.com/en-us/download/details.aspx?id=29696</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                        <listitem>
                            <para>At minimum, the following management
                                packs should be installed: <itemizedlist>
                                    <listitem>
                                     <para>Microsoft.Linux.Library.mp</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.Unix.Library.mp</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.SystemCenter.WSManagement.Library.mp</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>SUSE Manager Management Pack Installation
                    Requirements <itemizedlist>
                        <listitem>
                            <para>.NET 4.0 Framework must be installed
                                prior to running the SUSE Manager
                                Management Pack installer. The web
                                installer is available from the following
                                URL <itemizedlist>
                                    <listitem>
                                     <para>http://www.microsoft.com/en-us/download/details.aspx?id=17851</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            </listitem>
        </itemizedlist>

    </sect1>

    <sect1 xml:id="sec.manpacks">
        <title>Management Packs Required to Subscribe Clients to Microsoft
            System Center Operations Manager</title>
        <para>The following table lists the supported operating systems and
            required management packs to subscribe clients to Microsoft
            System Center Operations Manager.</para>


        <table>
            <title>Supported OS and Management Patches</title>
            <tgroup cols="4">
                <colspec colwidth="9cm"/>
                <colspec colwidth="1*"/>
                <colspec colwidth="1*"/>
                <colspec colwidth="1*"/>
                <thead>
                    <row>
                        <entry>Linux OS</entry>
                        <entry>Management Pack</entry>
                        <entry>SCOM 2007 Supportable</entry>
                        <entry>SCOM 2012/R2 Supportable</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>Red Hat Enterprise Linux 4 (x86/x64)</entry>
                        <entry>Microsoft.Linux.RHEL.4.mp</entry>
                        <entry>Yes</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>Red Hat Enterprise Linux 5 (x86/x64)</entry>
                        <entry>Microsoft.Linux.RHEL.5.mp</entry>
                        <entry>Yes</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>Red Hat Enterprise Linux 6 (x86/x64)</entry>
                        <entry/>
                        <entry>Yes</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>SUSE Linux Enterprise Server 9 (x86)</entry>
                        <entry>Microsoft.Linux.SLES.9.mp</entry>
                        <entry>Yes</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>SUSE Linux Enterprise Server 10
                            (x86/x64)</entry>
                        <entry>Microsoft.Linux.SLES.10.mp</entry>
                        <entry>Yes</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>SUSE Linux Enterprise Server 11
                            (x86/64)</entry>
                        <entry>Microsoft.Linux.SLES.11.mp</entry>
                        <entry>No</entry>
                        <entry>Yes</entry>
                    </row>
                    <row>
                        <entry>SUSE Linux Enterprise: Version 12
                            (x64)</entry>
                        <entry>Microsoft.Linux.SLES.12.mp</entry>
                        <entry>No</entry>
                        <entry>Yes</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>

    </sect1>

    <sect1 xml:id="sec.manpackinstall">
        <title>SUSE Manager Management Pack Installation</title>

        <para>To successfully perfom patch management tasks, the SUSE
            Manager Management Pack has be to installed on the Microsoft
            System Center Operations Manager Client (which is the system
            containing only Operations console) and on the Microsoft System
            Center Operations Manager Server system (which contains only
            the SCOM Server). One single SUSE Manager Management Pack
            Installer will work for the installation on both the SCOM
            Client and SCOM Server systems.</para>

        <para>Follow the below steps to install the SUSE Manager Management
            Pack:</para>

        <orderedlist>
            <listitem>
                <para>Copy the installer setup to the system where the
                    installation is required. Follow the below steps to
                    complete the installation process.</para>
                <itemizedlist>
                    <listitem>
                        <para>Right click on the command
                                <command>setup.exe</command> and select
                                <quote>Run as administrator </quote> as
                            shown below:</para>

                        <figure>
                            <title>SUSE Manager Management Pack Setup </title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-manpack-setup.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-manpack-setup.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>

                        <para>A setup wizard will open</para>

                        <figure>
                            <title>SUSE Manager Management Pack Setup
                                Wizard</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-welcome-wizard.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-welcome-wizard.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>

                    </listitem>

                    <listitem>
                        <para>Click on the <quote>Next</quote> button,
                            select the installation folder path and any of
                            the following options: <itemizedlist>
                                <listitem>
                                    <para>Everyone (can be used by all the
                                     users in the system)</para>
                                </listitem>
                                <listitem>
                                    <para>Just me (can be used only by the
                                     installed user)</para>
                                </listitem>
                            </itemizedlist>
                        </para>

                        <figure>
                            <title>Installation Folder Selection</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-select-folder.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-select-folder.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>
                    </listitem>

                    <listitem>
                        <para>Click on the <quote>Next</quote> button and
                            enter the SUSE Manager Credentials <itemizedlist>
                                <listitem>
                                    <para>SUSE Manager Server <important>
                                     <para>Do not include
                                     <quote>http/https</quote> in the
                                     hostname or IP address.</para>
                                     </important></para>
                                </listitem>
                                <listitem>
                                    <para>User Name</para>
                                </listitem>
                                <listitem>
                                    <para>Password</para>
                                </listitem>
                            </itemizedlist>
                        </para>
                        <para>These SUSE Manager details will be stored in
                            the registry keys (SUSEManagerUrl,
                            SUSEManagerUserName, and
                            SUSEManagerPassword).</para>

                        <figure>
                            <title>SUSE Manager Credentials</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-manpack-installation.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-manpack-installation.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>

                    </listitem>

                    <listitem>
                        <para>Click on the <quote>Next</quote> button, and
                            confirm the installation</para>

                        <figure>
                            <title>Installation Confirmation</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-confirm-installation.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-confirm-installation.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>
                    </listitem>

                    <listitem>
                        <para>During the installation the systems checks
                            whether all required management pack references
                            are installed or not. If they are not installed
                            it will prompt an error message with the
                            missing management pack references. When the
                            missing management packs are installed, the
                            installation will continue.</para>
                    </listitem>

                    <listitem>
                        <para>After the successful installation, click the
                                <quote>Close</quote> button to exit the
                            Wizard.</para>

                        <figure>
                            <title>Installation Completion</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-installation-complete.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-installation-complete.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>


                    </listitem>

                    <listitem>
                        <para>After the installation is completed, open the
                            SCOM 2007/2012/R2 console. On the Monitoring
                            Overview screen, check for the new entry and
                            click on the link <quote>Unix/Linux
                                Servers</quote>, after that click on the
                            link <quote>Linux</quote>. You should now see a
                            link called <quote>Patch Management</quote>.
                            See the screenshot below:</para>

                        <figure>
                            <title>Patch Management Selection</title>
                            <mediaobject>
                                <imageobject role="fo">
                                    <imagedata
                                     fileref="scom-install-patch-management.png"
                                     width="95%" format="PNG"/>
                                </imageobject>
                                <imageobject role="html">
                                    <imagedata
                                     fileref="scom-install-patch-management.png"
                                     width="90%" format="PNG"/>
                                </imageobject>
                            </mediaobject>
                        </figure>

                    </listitem>
                </itemizedlist>

            </listitem>
            <listitem>
                <para>After successful installation of the SUSE Manager
                    Management Pack the following binaries and management
                    packs are deployed in the SCOM root (for example
                    installation) location and the SCOM database
                    respectively. <itemizedlist>
                        <listitem>
                            <para>If the management pack is installed on a
                                system having only SCOM Client (system
                                having only Operations Console), the
                                following assemblies are placed into the
                                GAC folder (General path C;
                                c:\Windows\assembly). <itemizedlist>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.ViewType.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.Utilities.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManagerClient.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>CookComputing.XmlRpcV2.dll</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                            <para>The SUSE Manager credentials are updated
                                into the registry at
                                    <quote>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SUSEManagementPack</quote></para>
                        </listitem>

                        <listitem>
                            <para>If the management pack is installed on a
                                system having only the SCOM Server (system
                                having only SCOM Server) installed, the
                                following assemblies are placed into the
                                GAC folder (General path C;
                                c:\Windows\assembly). <itemizedlist>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.ScomModule.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.Utilities.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManagerClient.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>CookComputing.XmlRpcV2.dll</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                            <para>The management pack
                                    <quote>Microsoft.OpenSolutionsGroup.SuseManager.mp</quote>
                                is deployed into the SCOM database. The
                                SUSE Manager credentials are updated into
                                the registry
                                    <quote>“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SUSEManagementPack</quote>.
                            </para>
                        </listitem>

                        <listitem>
                            <para>If the management pack is installed on a
                                system having both the SCOM Client and the
                                SCOM Server (system having only SCOM
                                Server) installed, the following assemblies
                                are placed into the GAC folder (General
                                path C; c:\Windows\assembly). <itemizedlist>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.ViewType.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.ScomModule.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManager.Utilities.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>Microsoft.OpenSolutionsGroup.SuseManagerClient.dll</para>
                                    </listitem>
                                    <listitem>
                                     <para>CookComputing.XmlRpcV2.dll</para>
                                    </listitem>
                                </itemizedlist>
                            </para>

                            <para>The management pack
                                    <quote>Microsoft.OpenSolutionsGroup.SuseManager.mp</quote>
                                is deployed into the SCOM database. The
                                SUSE Manager credentials are updated into
                                the registry
                                    <quote>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SUSEManagementPack</quote>.
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>To update the SUSE Manager details after a successful
                    installation (for example pointing the SUSE Manager
                    Management Pack to a different SUSE Manager server
                    after the installation is completed) use the Desktop
                    shortcut <quote>SUSE Manager MP Settings</quote> or
                        <quote>SUSEManagerMPSettings.exe</quote> in the
                    Management Pack installation location.</para>
            </listitem>
            <listitem>
                <para>A log file <quote>LogInfo.txt</quote> exists in
                    Management Pack installation folder. This log file
                    keeps track of all activities done by the installer in
                    detail during the installation process. If the
                    installation fails, the installer will notify the user
                    with an error message, and error details are logged in
                    the log file.</para>

                <figure>
                    <title>Example for Log File Text</title>
                    <mediaobject>
                        <imageobject role="fo">
                            <imagedata
                                fileref="scom-install-loginfo-text.png"
                                width="95%" format="PNG"/>
                        </imageobject>
                        <imageobject role="html">
                            <imagedata
                                fileref="scom-install-loginfo-text.png"
                                width="90%" format="PNG"/>
                        </imageobject>
                    </mediaobject>
                </figure>

            </listitem>
        </orderedlist>


    </sect1>

    <sect1 xml:id="sec.manpackmanual">
        <title>SUSE Manager Management Pack Manual Installation
            Process</title>

        <para>For the manual installation of the SUSE Manager Management
            Pack installation follow the steps below:</para>

        <itemizedlist>
            <listitem>
                <para>Extract all files into a new folder.</para>
            </listitem>
            <listitem>
                <para>Place all binaries into the respective folder as
                    specified under section 3.2 (3.2.a to 3.2.c)
                    above.</para>
            </listitem>
            <listitem>
                <para>Use <quote>SUSEManagerMPSettings.exe</quote> from the
                    above extracted folder to update the SUSE Manager
                    credentials into registry.</para>
            </listitem>
            <listitem>
                <para>If you are installing the SUSE Manager Management
                    Pack on a system where SCOM Server is installed, open
                    theaApplication <quote>Operations Console</quote> and
                    import the SUSE Manager Management Pack
                    (Microsoft.OpenSolutionsGroup.SuseManager.mp) from
                    the above extracted folder into the SCOM Database.</para>
            </listitem>
        </itemizedlist>



        <simplelist>
            <member> </member>
            <member> </member>
            <member> </member>
        </simplelist>

        <orderedlist>
            <listitem>
                <para> </para>
            </listitem>
            <listitem>
                <para> </para>
                <para> </para>
            </listitem>
        </orderedlist>

        <note>
            <title> </title>
            <para> </para>
        </note>

        <figure>
            <title> </title>
            <mediaobject>
                <imageobject role="fo">
                    <imagedata fileref="screen-sp-migration.png"
                        width="95%" format="PNG"/>
                </imageobject>
                <imageobject role="html">
                    <imagedata fileref="screen-sp-migration.png"
                        width="90%" format="PNG"/>
                </imageobject>
            </mediaobject>
        </figure>


    </sect1>

</article>
